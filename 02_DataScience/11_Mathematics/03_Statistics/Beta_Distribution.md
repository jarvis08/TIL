# 베타 분포, beta Distribution

자료 출처: [datum.io](http://datum.io/tag/베타분포/), [ratsgo's blog](https://ratsgo.github.io/statistics/2017/05/28/binomial/)

‘posterior’의 분모 부분을 계산하지 않기 위해서 특별한 형태의 ‘prior’를 사용하는데, 이것이 베타 분포다. $p(y|θ)$와 $p(θ)$의 곱을 통해서 계산할 ‘posterior’가 다시 ‘prior’와 같은 형태의 수식이 나오도록 ‘prior’를 탐색한다. $p(y|θ)$의 모양은 이미 베르누이 분포로 정해졌으므로 이와 유사한 형태의 ‘prior’를 찾는 것이 유리한데, $θ^{a}(1−θ)^{b}$ 형태의 함수가 후보가 될 수 있다. 이를 단서로 찾은 것이 베타 분포이며 구체적인 형태는 아래와 같다.

$p(θ|a,b)=beta(θ|a,b)=\frac{θ^{(a−1)}(1−θ)^{(b−1)}}{B(a,b)}$

분모의 B(a,b)B(a,b)는 확률 분포의 적분 값이 1이 되도록 만들어주기 위한 상수로, 베타 함수(beta function)라 한다. 베타 함수는 $B(a,b)=∫^{1}_{0}θ^{(a−1)}(1−θ)^{(b−1)}dθ$ 로 정의한다.

**베타분포(beta distribution)**란 두 매개변수 α와 β에 대해 $[0,1]$에서 정의되는 연속확률분포들의 가족을 가리킵니다. 베타분포의 확률밀도함수는 다음과 같습니다.

$f(x;α,β)=\frac{Γ(α+β)}{Γ(α)Γ(β)}x^{α−1}(1−x)^{β−1}$

베타분포의 확률밀도함수인 감마함수 $Γ$는 다음과 같이 정의됩니다.

$Γ(n)=(n−1)!$

<br>

<br>

## 베타 사전 확률 분포

- 성공 횟수 : $α−1$
- 실패 횟수 : $β−1$

사전 확률을 잘 정하는 것이 중요하므로 베타 분포의 두 모수를 잘 조정하여 원하는 형태의 사전 확률 분포를 결정한다.

위의 베타 분포는 $a, b$ 2개의 모수를 가지고 있는데, 이를 마치 이전에 관찰한 데이터라고 간주하면 사전 확률의 모양을 결정하기가 쉽다. 즉, $a+b$ 번 동전을 던졌을 때, $a$번 앞면이 나왔다고 생각하면 사전 확률의 모양이 결정된다.

만약, $a=1, b=1$로 베타 분포의 모수를 결정하면, 사전 확률은 균등 분포(uniform distribution)가 된다. 동전을 2번 던졌을 때, 1번 앞면이 나왔다고 가정하면 동전의 앞면이 나올 확률에 대해서 특별한 정보가 없다고 간주하는 것이다.

만약 $a=4, b=4$로 베타 분포의 모수를 결정하면, $θ=0.5$를 중심으로 종 모양 형태의 사전 확률 분포를 얻게 된다. 이는 8번 동전을 던졌을 때, 앞면이 4번 나온 경우로 볼 수 있으므로 동전의 앞면이 나올 확률이 0.5에 가깝다는 믿음을 강하게 믿는 것이다. 아래 그림을 보면 특정 모수 값에서 사전 확률 분포가 어떤 모양을 갖는지 알 수 있다.

[![2014-08-26_12-34-37](http://datum.io/wp-content/uploads/2014/08/2014-08-26_12-34-37.jpg)](http://datum.io/wp-content/uploads/2014/08/2014-08-26_12-34-37.jpg)

<br>

<br>

## 베타 사후 확률 분포

N번 동전을 던져서 z번 앞면이 나오는 데이터를 가정하면, 베타 사전 확률과 베르누이 우도(bernoulli likelihood)를 이용하여 베타 분포의 모양을 갖는 사후 확률(posterior)을 얻을 수 있다.

$p(θ|z,N)=\frac{p(z,N|θ)p(θ)}{p(z,N)}=\frac{θ^{z}(1−θ)^{(N−z)}θ^{(a−1)}(1−θ)^{(b−1)}}{B(a,b)p(z,N)}=\frac{θ^{((z+a)−1)}(1−θ)^{((N−z+b)−1)}}{B(z+a,N−z+b)}$

즉, 사전 확률이 $beta(θ|a,b)$이고 데이터가 $N$번 동전을 던져서 $z$번 앞면이 나오는 경우라면, 사후 확률 분포는 $beta(θ|z+a,N−z+b)$가 된다. 사후 확률 분포의 평균은 $\frac{(z+a)}{(N+a+b)}$가 되는데, 이는 데이터에서 앞면이 나온 비율($=\frac{z}{N}$)과 사전 확률 분포의 평균($=\frac{a}{a+b}$)의 가중 평균으로 해석할 수 있다. 데이터를 관찰하기 전의 사전 믿음에 데이터의 정보가 추가되어, 사후 믿음을 도출하는 정반합의 과정을 보여준다.

<br>

<br>

## 이항 비율 추정하기

실제로 위에서 정리한 베타 사후 확률 분포로 동전의 앞면이 나올 확률을 추정하면 아래와 같이 정리할 수 있다. 좌측의 경우에는 사전 확률 분포를 $beta(θ|1,1)$로 설정하였고, 우측의 경우에는 $beta(θ|100,100)$으로 설정하였다. 좌측의 경우에는 데이터를 관찰하기 전에 동전의 앞면이 나올 확률에 대해서 별 다른 믿음을 갖고 있지 않다. 즉, 모든 확률이 동일한 정도로 나올 수 있다는 가정에서 출발한다. 반면에 우측은 사전 확률 분포의 모양이 $θ=0.5$를 중심으로 모여있다. 즉, 데이터를 관찰하기 전에도 동전의 앞면이 나올 확률이 0.5에 가까울 것이라고 강하게 믿는 것이다.

[![2014-08-26_14-42-36](http://datum.io/wp-content/uploads/2014/08/2014-08-26_14-42-361.jpg)](http://datum.io/wp-content/uploads/2014/08/2014-08-26_14-42-361.jpg)

관찰한 데이터는 양쪽 모두 $z=11, N=14$로 같다. 14번 동전을 던져서 11번 앞면이 나왔다. 따라서 양쪽 모두 베르누이 가능도(likelihood)는 같은 모습을 보이고 있다. 최종적으로 사전 확률 분포와 베르누이 가능도를 합쳐서 만들어낸 사후 확률 분포는 양쪽이 확연히 다르다. 같은 데이터를 관찰하였지만, 사전 확률 분포의 모양에 따라서 그 결과가 다르게 나타난 것이다. 왼쪽의 경우, 사전 확률 분포에서 $θ$값에 대한 치우침에 별다른 정보가 없었기 때문에 사후 확률 분포는 데이터의 영향을 받는 베르누이 가능도와 거의 같은 모양을 보이고 있다. 반면에 오른쪽의 경우에는 $θ=0.5$라는 강한 사전 믿음이 있었기 때문에 데이터를 관찰한 이후에도 사후 확률 분포의 모양이 사전 확률 분포와 흡사하다.

