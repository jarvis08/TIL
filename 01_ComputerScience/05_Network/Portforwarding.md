# Portforwarding

LAN이 아닌, 와이파이 환경의 서버에 접속하고자 합니다. 그리고, 이를 위해 어떤 작업들을 해주어야 할 지 알아보겠습니다. 모든 작업들은 iptime 관리자 페이지에서 진행 가능하며, 관리자 페이지는 `192.168.0.1`를 브라우저 주소창에 검색하는 것으로 접속할 수 있습니다. 만약 직접 수정한 적이 없다면, ID와 PW는 모두 default 값으로 `admin`입니다.

자세한 설명을 시작하기 전, 서버에 접속하는 과정을 간략하게 말하자면 다음과 같습니다.

1. `remote`(macbook)에서 `특정 포트`(공유기에 설정된)로 `특정 주소`(**공유기의 주소**)로 접근 요청
2. `공유기`가 `remote`를 `특정 포트`에 할당된 `특정 서버`로 연결

<br>

### 1. 원격 관리 포트

우선 외부에서 나의 공유기의 ip 주소를 탐색할 수 있도록 해야 합니다. 해외의 경우는 잘 모르겠지만, 한국의 경우 대체로 와이파이 기기로 iptime을 사용합니다. 그리고 iptime의 경우 이를 매우 간편하게 진행할 수 있습니다.

- `고급 설정` > `보안 기능` > `공유기 접속/보안관리`에서 `원격 관리 포트 사용`을 활성화

<br>

### 2. 포트포워드

`고급 설정` > `NAT/라우터 관리` > `포트포워드 설정` 에서 규칙을 추가해야 합니다. 해당 규칙은 공유기로 특정 포트로 접근해 오는 신호에 대해, 미리 지정해 둔 포트에 해당하는 서버로 연결해주는 행위를 규정합니다. 즉, `외부 포트`를 입력하여 공유기의 `외부 IP 주소`로 접속 시, 공유기는 설정된 `외부 포트`에 해당하는 server로 연결해 줍니다. 공유기의  `외부 IP 주소`는 `시스템 요약 정보`에서 확인할 수 있습니다.

만약 `22`의 포트 번호를 `외부 포트`로 설정했다면, 다음과 같은 코드로 서버에 접속할 수 있습니다.

- `ssh -p 22 <username>@외부 IP 주소` 
- `<username>@<DDNS이름>.iptime.org`

물론 아직 `iptime.org` 형태로 하는 것은 불가능합니다. 이는 아래 DDNS 설정 이후 사용할 수 있습니다.

<br>

## 해두면 편리한 DDNS

### 3. DDNS

DDNS의 [위키](https://ko.wikipedia.org/wiki/DDNS) 정의는 다음과 같다.

>  **DDNS** 또는 **Dynamic DNS**(동적 DNS)는 실시간으로 [DNS](https://ko.wikipedia.org/wiki/도메인_네임_시스템)를 갱신하는 방식이다. 주로 도메인의 [IP](https://ko.wikipedia.org/wiki/인터넷_프로토콜)가 유동적인 경우 사용된다. ip가 바뀌어도 ddns로 설정한 도메인값은 변하지 않기 때문에 용이하게 접속가능하다.

DDNS 설정 시, `시스템 요약 정보` 에 보이는 `외부 IP 주소` 에 적힌 주소를, `<DDNS이름>.iptime.org` 형태로 사용 가능하도록 만들어줍니다. `192.xxx.x.x` 형태의 외우기 어려운 ip 주소를 `<설정한이름>.iptime.org`와 같은 간단한 도메인 주소 형태로 사용할 수 있게 해줍니다.

추가적으로, 위 `1.원격 관리 포트`에서 설정한 포트 번호를 붙인다면, 외부에서도 iptime 관리자 페이지를 접속할 수 있습니다. 브라우저에 입력하는 형태는 다음과 같습니다.

- `<DDNS이름>.iptime.org:<원격 관리 포트 번호>`



